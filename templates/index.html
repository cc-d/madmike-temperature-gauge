<!DOCTYPE html>
<head>
	<title>Temperature Data</title>
	<script type="text/javascript" src="{{ url_for('static', filename='jquery-3.3.1.js') }}"></script>
	<script type="text/javascript" src={{ url_for('static', filename='plotly-latest.min.js') }}></script>
</head>
<body>
<div id='myDiv'>
</div>
<script>

var req = new XMLHttpRequest();
req.overrideMimeType("application/json");
req.open('GET', 'api/temperature_history', true);
req.onload  = function() {
	times = []
	temps = []

	jdata = JSON.parse(req.responseText);
	console.log(jdata[0]);
	l = 100;
	for (i=0; i<l; i++) { //i<jdata.length; i++) {
		rec = jdata[i];
		console.log(rec['f'], rec['time']);
		temps.push(rec['f']);
		times.push(rec['time']);
	}
	var data = [{
		//x: ['2013-10-04 22:23:00', '2013-11-04 22:23:00', '2013-12-04 22:23:00'],
		//y: [1, 3, 6],
		x: times.sort(),
		y: temps,
		type: 'scatter'
	}];
	Plotly.newPlot('myDiv', data);
};
req.send(null);


/*
var red = {
  type: "scatter",
  mode: "lines",
  name: 'AAPL High',
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'AAPL.High'),
  line: {color: '#17BECF'}
}

var trace1 = {
  type: "scatter",
  mode: "lines",
  name: 'AAPL High',
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'AAPL.High'),
  line: {color: '#17BECF'}
}

var trace2 = {
  type: "scatter",
  mode: "lines",
  name: 'AAPL Low',
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'AAPL.Low'),
  line: {color: '#7F7F7F'}
}

var data = [trace1,trace2];

var layout = {
  title: 'Basic Time Series',
};

Plotly.newPlot('myDiv', data, layout);
})

*/


/*function r(a, b){
	return Math.floor(Math.random() * b) + a 
}

var times = []
var temps = []
var day = 0;
var mcount = 0
var ma = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul']


for (i=0; i<=100; i++){
	var at = String(r(5, 10)) + '.' + String(r(1,9));
	//console.log(at);
	console.log(day);
	temps.push(at);
	day = day + 1;
	if (day % 31 === 0) {
		day = 0;
		mcount += 1;
	}
	times.push(String(ma[mcount]) + ' ' + String(day));
}

var data = [
  {
    x: times,
    y: temps,
    type: 'scatter'
  }
];

Plotly.newPlot('myDiv', data);
*/
</script>
</body>
</html>
